---
layout: post
title: Compte rendu de l'atelier Node.js
date: 2017-10-23 20:23:48.000000000 +02:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- The Blog
tags: []
meta:
  _yoast_wpseo_primary_category: ''
  wpautop: "- Select -"
  skin: "- Select -"
  layout_footer: "- Select -"
  layout_header: "- Select -"
  layout: "- Select -"
  _edit_last: '2427'
  _thumbnail_id: '207335'
author:
  login: Tariq
  email: tariq.benezza@gmail.com
  display_name: Tariq
  first_name: Tariq
  last_name: Benezza
permalink: "/compte-rendu-de-latelier-node-js/"
---
<p>Avant tout merci !</p>
<p>Si <em>Le Cid</em> avait été écrit durant l'atelier cela aurait ressemblé à cela :<br />
<em><br />
Nous partîmes cinq cents ; mais par un prompt renfort,<br />
Nous nous vîmes trois mille en arrivant au port 3000</em></p>
<p>Finalement Florian avec ce super workshop est le nouveau Corneille :</p>
<p><iframe width="560" height="315" src="https://www.youtube.com/embed/NqfP0Yhbif4" frameborder="0" allowfullscreen></iframe></p>
<h3>Déroulement</h3>
<p>Voilà à peu de chose près comment s'est passé notre soirée :</p>
<ul>
<li>Découverte des outils</li>
<li>Découverte de l'API Twitter</li>
<li>Création d'un serveur Node.js</li>
<li>Création du client Twitter</li>
<li>Création endpoints/tweets</li>
<li>Création endpoints API REST (tweets, homepage)</li>
</ul>
<h3>Les outils</h3>
<p>Les outils que nous avons utilisé sont les suivants :</p>
<ul>
<li><strong>Node.JS/Javascript</strong></li>
<p>Vous pouvez télécharger node.js <a href="https://nodejs.org/en/" target="_blank">ici même</a>. </p>
<li><strong>NPM</strong></li>
<p>Le Node Package Manager. Il est livré avec node.js ci dessus</p>
<li><strong>API Twitter</strong></li>
<p>Une inscription vérifiée est nécessaire pour utiliser l'API Twitter. Vous devez donc avoir un compte twitter et le vérifier avec un numéro de mobile. Ensuite la création des identifiants se fait <a href="https://apps.twitter.com/" target="_blank">ici</a>.</p>
<li><a href="http://leafletjs.com/" target="_blank"><strong>Leaflet</strong></a></li>
<p>C'est une librairie Javascript qui va vous permettre d'enrichir vos cartes interactives.</p>
<li><strong>Git</strong></li>
<p>On ne le présente plus mais si vous souhaitez en savoir plus <a href="https://twitter.com/JbIPS" target="_blank">JB</a> nous anime <a href="https://www.silexlabs.org/event/introduction-a-git-versionning/" target="_blank">une formation le 07 Novembre</a>.<br />
Nous vous y attendons nombreux.
</ul>
<h3>Node.js ? C'est quoi</h3>
<ul>
<li>Plateforme de développement</li>
<li>Utilise la machine virtuelle V8</li>
<li>Orienté événement</li>
<li>Libre sous licence MIT</li>
<li>Server side</li>
<li>Single threaded</li>
</ul>
<h3>Standard REST</h3>
<ul>
<li>Representational state transfer</li>
<li>Créé en 2000 par Roy Fielding dans sa thèse "Architectural Styles and the Design of Network-based Software Architectures".</li>
<li>Échanges client-serveur</li>
<li>Serveur sans état (chaque requête d'un client contient toute l'information nécessaire)</li>
<li>Interface uniforme</li>
<li>Création page HTML & endpoint</li>
</ul>
<h3>Architecture</h3>
<p><img src="{{ site.baseurl }}/assets/Untitled-drawing-300x119.png" alt="untitled-drawing" width="560" height="222" class="alignnone size-medium wp-image-207320" /></p>
<h3>API Twitter</h3>
<p>Il suffit de s'inscrire sur Twitter, de renseigner un numéro de portable et de créer son App ici :</p>
<p><a href="https://apps.twitter.com/" target="_blank">https://apps.twitter.com/</a></p>
<p>Et voilà à quoi tout cela devrait ressembler</p>
<p><img src="{{ site.baseurl }}/assets/Presateliernodejs.odp-300x276.png" alt="presateliernodejs-odp" width="560" height="515" class="alignnone size-medium wp-image-207324" /></p>
<h3>Le code du serveur Node</h3>
<p><code><br />
'use strict'<br />
const express = require('express')<br />
const app = express()<br />
const port = 3000<br />
app.listen(port, (err) => {<br />
if(err){<br />
return console.log('Error', err)<br />
}<br />
}<br />
</code></p>
<h3>Le client Twitter</h3>
<p>Dans le terminal installer le package desmondmorris/node-twitter<br />
<code>npm install -save twitter</code></p>
<p>Puis créer un fichier twitter-client.js en utilisant les clés générés plus haut dans l'interface app Twitter</p>
<p><code><br />
'use strict'<br />
const Twitter = require('twitter')<br />
const client = new Twitter({<br />
  consumer_key: process.env.TWITTER_CONSUMER_KEY,<br />
  consumer_secret: process.env.TWITTER_CONSUMER_SECRET,<br />
  access_token_key: process.env.TWITTER_ACCESS_TOKEN_KEY,<br />
  access_token_secret: process.env.TWITTER_ACCESS_TOKEN_SECRET<br />
});<br />
module.exports = client<br />
</code></p>
<h3>Le endpoint à la racine</h3>
<p>Ou point d'entrée principal</p>
<p><code><br />
/*<br />
 * GET /<br />
 * Serve front page<br />
 */<br />
app.get('/', (req, res) => {<br />
	res.sendFile(__dirname + '/index.html')<br />
})<br />
</code></p>
<h3>Endpoint /tweet</h3>
<p>Ou point d'entrée de notre requête /tweets</p>
<p><code><br />
/*<br />
 * GET /tweets<br />
 * REST endpoint to get tweets<br />
 * @param {String} q paris<br />
 * @param {String} latlon 48.8669576,2.3116284,5km<br />
 */<br />
app.get('/tweets', (req, res) => {<br />
	if (req.query.q !== null && req.query.latlon !== null && req.query.q !== '' && req.query.latlon !== '') {<br />
		twitter.get('search/tweets', {<br />
				q: req.query.q,<br />
				geocode: req.query.latlon,<br />
				count: 100<br />
			})<br />
			.then(function (tweets) {<br />
				// Filter Twitter API results with only tweets with geo field<br />
				let filteredTweets = tweets.statuses.filter(o => o.geo !== null)</p>
<p>				res.send(filteredTweets)<br />
			})<br />
			.catch(function (error) {<br />
				res.status(500).send(error)<br />
			})<br />
	} else {<br />
		res.sendStatus(400)<br />
	}<br />
})<br />
</code></p>
<h3>Page HTML & Leaflet</h3>
<p>Pour la page HTML et la configuration de Leaflet nous vous invitons à <a href="https://github.com/FTwex" target="_blank">follow Florian sur github</a> mais également à <a href="https://github.com/FTwex/atelier-node" target="_blank">cloner le repo de l'atelier</a>. Des dires même de notre expert l'API Leaflet est suffisamment bien faite pour que vous puissiez jouer avec de façon autonome. </p>
<p>Nous restons à disposition sur le <a href="https://framateam.org/login?redirect_to=%2Fsilexlabs%2Fchannels%2Ftown-square" target="_blank">chat</a>, sur <a href="https://twitter.com/silexlabs" target="_blank">twitter</a>, sur <a href="https://github.com/silexlabs" target="_blank">github</a> et par <a href="mailto:contact@silexlabs.org?Subject=Salut%20la%20compagnie" target="_top">mail</a> si vous avez la moindre question. </p>
<p>A très vite !</p>
