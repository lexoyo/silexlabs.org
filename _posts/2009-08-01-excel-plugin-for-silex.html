---
layout: post
title: Excel plugin for silex
date: 2009-08-01 20:02:49.000000000 +02:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Plugins
tags: []
meta:
  color: orange
  _epLastMessage: ''
  _itemCurrentVersion: v1.0
  _epLastError: ''
  _epDependencies: a:0:{}
  _itemCurrentFileName: excel plugin for silex v1.1 3.zip
  _selectedProject: Silex
  _selectedVersionsArray: v1.6.0,v1.6.1,v1.5.x
author:
  login: admin
  email: contact@silexlabs.org
  display_name: Silex Labs
  first_name: Silex Labs
  last_name: ''
permalink: "/excel-plugin-for-silex/"
---
<h1>Sources</h1>
<p>version 1.0 : <a href="http://wp-manager.silexlabs.org/wp-content/uploads/2009/08/excel-plugin-for-silex.zip" target="_blank">excel plugin for silex</a></p>
<p>version 1.1 : <a href="http://wp-manager.silexlabs.org/wp-content/uploads/2009/08/excel-plugin-for-silex-v111.zip">excel-plugin-for-silex-v1.1</a></p>
<h2>Versions</h2>
<p>v1.0<span> </span></p>
<ul>
<li>2009/08/01</li>
</ul>
<p>v1.1<span> </span></p>
<ul>
<li>2010/03/04</li>
<li>xls and xlsx support in excel_compute script</li>
</ul>
<h3>Presentation</h3>
<p>Use PHPExcel to set values  and get values from an Excel sheet. The result is an RSS feed which you can use in Silex with the Oof RSSConnector component. Formulas of the cells are interpreted thanks to <a title="phpExcel" href="http://www.codeplex.com/PHPExcel" target="_blank">phpExcel</a>.</p>
<p>You can set the values you want and get other cells which are supposed to contain the result.</p>
<h3>Example</h3>
<p>For example if you want to display a list of prices for some fruits at a given date:<br />
<img class="aligncenter size-full wp-image-254" title="excel-example" src="{{ site.baseurl }}/assets/excel-example.jpg" alt="excel-example" width="295" height="153" /></p>
<p>Let's say the day is set in excel in the column A1, the labels are in the column B and the prices are formulas in the column C. You want to display a list with all fruits and their prices.</p>
<p>So you simply put the Oof components on the Stage in silex:</p>
<ul>
<li>RSSConnector
<ul>
<li>URL prefix = &lt; &lt; silex.rootUrl&gt; &gt; /cgi/scripts/</li>
</ul>
</li>
<li>DataSelector
<ul>
<li>enter the connector and list names</li>
<li>source = excel_compute.php?set_values=A2:DATE&amp;get_values=B2-C5&amp;file_name=media/test_xls.xlsx - but replace "DATE" by the date you want (if it is different from the one which is in the excel file allready). The "DATE" value can be entered by the user for exemple or be the date of today (use silex accessors)</li>
</ul>
</li>
<li>RichTextList
<ul>
<li>cell content = &lt; &lt; B&gt; &gt;  costs &lt; &lt; C&gt; &gt;  Euros</li>
</ul>
</li>
</ul>
<p>It makes this happend:</p>
<p style="text-align: center;"><img class="aligncenter size-large wp-image-257" title="excel-example2" src="{{ site.baseurl }}/assets/excel-example2-1024x549.jpg" alt="excel-example2" width="717" height="384" /></p>
<h2>The script which you call with the Oof components</h2>
<h3>Inputs</h3>
<div>
<div>
<ul>
<li>set_values a suite of cell names and value pairs - e.g. C1:21,C2:test,C3:6</li>
<li>get_values values to be retrurned - may be a range - e.g. A1,C2-F15,G6</li>
<li>file_name name of the xlsx file</li>
<li>sheet_number sheet number - default is 0</li>
<li>example excel_compute.php?set_values=C3:654,C4:444&amp;get_values=C11&amp;file=media/btt.xlsx =&gt; retrieve the value of C11 when C3 is set to 654 and C4 is set to 444</li>
<li>example excel_compute.php?set_values=C3:333,C4:444&amp;get_values=C11,C13,C14&amp;file_name=media/btt.xlsx</li>
</ul>
</div>
</div>
<h3>Result</h3>
<p>An RSS2 feed with all the desired cells. Title tag is the line number, other tags have the name of the column and the value of the corresponding cell (col,line).</p>
<p>For example, the items could be like this:</p>
<pre>
<pre id="line19">	&lt;<span class="start-tag">item</span>&gt;
		&lt;<span class="start-tag">title</span>&gt;<span class="cdata">&lt;![CDATA[4]]&gt;</span>&lt;/<span class="end-tag">title</span>&gt;
		&lt;<span class="start-tag">G</span>&gt;<span class="cdata">&lt;![CDATA[Oranges]]&gt;</span>&lt;/<span class="end-tag">G</span>&gt;
		&lt;<span class="start-tag">H</span>&gt;<span class="cdata">&lt;![CDATA[38]]&gt;</span>&lt;/<span class="end-tag">H</span>&gt;</pre>
<pre id="line28">		&lt;<span class="start-tag">I</span>&gt;<span class="cdata">&lt;![CDATA[EUR]]&gt;</span>&lt;/<span class="end-tag">I</span>&gt;
	&lt;/<span class="end-tag">item</span>&gt;
	&lt;<span class="start-tag">item</span>&gt;
		&lt;<span class="start-tag">title</span>&gt;<span class="cdata">&lt;![CDATA[5]]&gt;</span>&lt;/<span class="end-tag">title</span>&gt;
		&lt;<span class="start-tag">G</span>&gt;<span class="cdata">&lt;![CDATA[Pommes]]&gt;</span>&lt;/<span class="end-tag">G</span>&gt;
		&lt;<span class="start-tag">H</span>&gt;<span class="cdata">&lt;![CDATA[41]]&gt;</span>&lt;/<span class="end-tag">H</span>&gt;
		&lt;<span class="start-tag">I</span>&gt;<span class="cdata">&lt;![CDATA[DOLAR]]&gt;</span>&lt;/<span class="end-tag">I</span>&gt;
	&lt;/<span class="end-tag">item</span>&gt;</pre>
<h3>Requirements</h3>
<p>The following requirements should be met prior to using PHPExcel:</p>
<p>* PHP version 5.2 or higher</p>
<p>* oof components and silex</p>
<h3>Installation</h3>
<p>- copy includes/phpexcel/ folder into [silex installation folder]/cgi/includes/</p>
<p>- copy excel_compute.php to [silex installation folder]/cgi/scripts/</p>
<h3>Test</h3>
<p>- copy test_xls.xlsx in [silex installation folder]/media/</p>
<p>- call the script like this: http://mysilexserver.com/cgi/scripts/excel_compute.php?set_values=H3:25,H4:38&amp;get_values=H7,H8,H10,H12&amp;file_name=media/test_xls.xlsx</p>
<h3>Help</h3>
<p>- call the script without any parameter to display help</p>
